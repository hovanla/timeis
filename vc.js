(async()=>{const t=[{p:0x4ad4eaf449000,c:"CRMNUICLHCMT1",s:"c847bfced76531f9f5ad608e27756b312e3a31d4769fe9e07135f07f1902b276"},{p:0x4ad4eaec89000,c:"CRMNUICLSOUTHT1",s:"14bac24168c50efa23b84f0c40d2a5002855b3e66be9f6405977d2898006973f"}],e=document,a=e.body,o=e.createElement("div");o.innerHTML='<div style="position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;padding:20px;border-radius:10px;z-index:999999;box-shadow:0 0 20px rgba(0,0,0,.5)"><div id="qi"></div><p id="qs">‚è≥</p></div>',a.appendChild(o);const n=t=>e.getElementById(t);try{const e=await(await fetch("/api/v2/authentication/gen_qrcode")).json();let a;n("qi").innerHTML=`<img src="data:image/png;base64,${e.data.qrcode_base64}" width=180>`,n("qs").textContent="üì± Qu√©t QR";for(let t=0;t<60&&!a;t++){await new Promise(t=>setTimeout(t,2e3));const t=await(await fetch("/api/v2/authentication/qrcode_status?qrcode_id="+encodeURIComponent(e.data.qrcode_id))).json();if("CONFIRMED"===t.data?.status)a=t.data.qrcode_token;else if("EXPIRED"===t.data?.status)return void(n("qs").textContent="‚è∞ H·∫øt h·∫°n")}if(!a)return void(n("qs").textContent="‚è∞ Timeout");n("qs").textContent="üîê Login...",await fetch("/api/v2/authentication/qrcode_login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({qrcode_token:a})}),n("qs").textContent="üé´ Saving...";let i=0;for(const e of t){0===(await(await fetch("/api/v2/voucher_wallet/save_vouchers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({voucher_identifiers:[{promotion_id:e.p,voucher_code:e.c,signature:e.s,signature_source:0}],need_user_voucher_status:!0})})).json()).error&&i++}n("qs").textContent=`‚úÖ ${i}/${t.length}`,setTimeout(()=>o.remove(),2e3)}catch(t){n("qs").textContent="‚ùå"+t}})();